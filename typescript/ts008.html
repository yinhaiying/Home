<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>高级类型 | 海鹰斯坦的个人主页</title>
    <meta name="description" content="海鹰斯坦的个人主页">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/Home/assets/css/0.styles.e94f337b.css" as="style"><link rel="preload" href="/Home/assets/js/app.4e9de29e.js" as="script"><link rel="preload" href="/Home/assets/js/2.852f0768.js" as="script"><link rel="preload" href="/Home/assets/js/63.95bb274b.js" as="script"><link rel="prefetch" href="/Home/assets/js/10.8473db2b.js"><link rel="prefetch" href="/Home/assets/js/11.b4241947.js"><link rel="prefetch" href="/Home/assets/js/12.b09a44ea.js"><link rel="prefetch" href="/Home/assets/js/13.d63114f0.js"><link rel="prefetch" href="/Home/assets/js/14.0b8be25b.js"><link rel="prefetch" href="/Home/assets/js/15.bd62ea79.js"><link rel="prefetch" href="/Home/assets/js/16.cc1ee14d.js"><link rel="prefetch" href="/Home/assets/js/17.1ef904c7.js"><link rel="prefetch" href="/Home/assets/js/18.e0a82910.js"><link rel="prefetch" href="/Home/assets/js/19.38d174c3.js"><link rel="prefetch" href="/Home/assets/js/20.aa3ff896.js"><link rel="prefetch" href="/Home/assets/js/21.c79e05d9.js"><link rel="prefetch" href="/Home/assets/js/22.da13ae6a.js"><link rel="prefetch" href="/Home/assets/js/23.78c92169.js"><link rel="prefetch" href="/Home/assets/js/24.94b7a7ff.js"><link rel="prefetch" href="/Home/assets/js/25.5b167e5d.js"><link rel="prefetch" href="/Home/assets/js/26.d3807609.js"><link rel="prefetch" href="/Home/assets/js/27.50f8fd8e.js"><link rel="prefetch" href="/Home/assets/js/28.69c4d2e9.js"><link rel="prefetch" href="/Home/assets/js/29.24a2de88.js"><link rel="prefetch" href="/Home/assets/js/3.ab36bc1f.js"><link rel="prefetch" href="/Home/assets/js/30.2c780612.js"><link rel="prefetch" href="/Home/assets/js/31.a3bef37b.js"><link rel="prefetch" href="/Home/assets/js/32.c42a9904.js"><link rel="prefetch" href="/Home/assets/js/33.2fba6d41.js"><link rel="prefetch" href="/Home/assets/js/34.76e04935.js"><link rel="prefetch" href="/Home/assets/js/35.00510acc.js"><link rel="prefetch" href="/Home/assets/js/36.62b6e63f.js"><link rel="prefetch" href="/Home/assets/js/37.42dd3af6.js"><link rel="prefetch" href="/Home/assets/js/38.ce73a544.js"><link rel="prefetch" href="/Home/assets/js/39.f02bc307.js"><link rel="prefetch" href="/Home/assets/js/4.3e212fe4.js"><link rel="prefetch" href="/Home/assets/js/40.5e347b91.js"><link rel="prefetch" href="/Home/assets/js/41.c4785cba.js"><link rel="prefetch" href="/Home/assets/js/42.7b055896.js"><link rel="prefetch" href="/Home/assets/js/43.38197c33.js"><link rel="prefetch" href="/Home/assets/js/44.bad3d004.js"><link rel="prefetch" href="/Home/assets/js/45.e1f5c336.js"><link rel="prefetch" href="/Home/assets/js/46.e4dd4809.js"><link rel="prefetch" href="/Home/assets/js/47.44cdcf1f.js"><link rel="prefetch" href="/Home/assets/js/48.6b0bcf94.js"><link rel="prefetch" href="/Home/assets/js/49.f84d8c11.js"><link rel="prefetch" href="/Home/assets/js/5.c75cc4d2.js"><link rel="prefetch" href="/Home/assets/js/50.62bd8e57.js"><link rel="prefetch" href="/Home/assets/js/51.b9cec1fc.js"><link rel="prefetch" href="/Home/assets/js/52.fc7f7a1a.js"><link rel="prefetch" href="/Home/assets/js/53.b13a962e.js"><link rel="prefetch" href="/Home/assets/js/54.ec6286b0.js"><link rel="prefetch" href="/Home/assets/js/55.7996b340.js"><link rel="prefetch" href="/Home/assets/js/56.97d6f2d9.js"><link rel="prefetch" href="/Home/assets/js/57.0df64cb1.js"><link rel="prefetch" href="/Home/assets/js/58.c30a5bea.js"><link rel="prefetch" href="/Home/assets/js/59.7c9a8b47.js"><link rel="prefetch" href="/Home/assets/js/6.b1439560.js"><link rel="prefetch" href="/Home/assets/js/60.fc89a25b.js"><link rel="prefetch" href="/Home/assets/js/61.3c3dc19e.js"><link rel="prefetch" href="/Home/assets/js/62.2970193a.js"><link rel="prefetch" href="/Home/assets/js/64.f0d5cf0c.js"><link rel="prefetch" href="/Home/assets/js/65.d6318947.js"><link rel="prefetch" href="/Home/assets/js/66.8eff8ba2.js"><link rel="prefetch" href="/Home/assets/js/67.cfc67837.js"><link rel="prefetch" href="/Home/assets/js/68.2fa4de54.js"><link rel="prefetch" href="/Home/assets/js/69.f6ca426c.js"><link rel="prefetch" href="/Home/assets/js/7.f227c584.js"><link rel="prefetch" href="/Home/assets/js/70.6d1e6835.js"><link rel="prefetch" href="/Home/assets/js/8.f8a0efca.js"><link rel="prefetch" href="/Home/assets/js/9.2c44c2a4.js">
    <link rel="stylesheet" href="/Home/assets/css/0.styles.e94f337b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Home/" class="home-link router-link-active"><img src="/Home/assets/logo.jpg" alt="海鹰斯坦的个人主页" class="logo"> <span class="site-name can-hide">海鹰斯坦的个人主页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Home/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Home/javascript/js/js001.html" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/Home/typescript/" class="nav-link router-link-active">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/Home/vue/vue001.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/Home/react/react001.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Home/node/node001.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/Home/design-pattern/dm001.html" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Home/php/php001.html" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/Home/mysql/mysql001.html" class="nav-link">
  MySQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Home/computer-net/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/Home/operate-system/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/Home/data-structure/" class="nav-link">
  数据结构和算法
</a></li></ul></div></div><div class="nav-item"><a href="/Home/program/" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/Home/interview/" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="/Home/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/Home/tools/tools/tools001.html" class="nav-link">
  常用网站及工具
</a></div> <a href="https://github.com/yinhaiying/Home" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Home/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Home/javascript/js/js001.html" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/Home/typescript/" class="nav-link router-link-active">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/Home/vue/vue001.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/Home/react/react001.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Home/node/node001.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/Home/design-pattern/dm001.html" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Home/php/php001.html" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/Home/mysql/mysql001.html" class="nav-link">
  MySQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Home/computer-net/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/Home/operate-system/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/Home/data-structure/" class="nav-link">
  数据结构和算法
</a></li></ul></div></div><div class="nav-item"><a href="/Home/program/" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/Home/interview/" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="/Home/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/Home/tools/tools/tools001.html" class="nav-link">
  常用网站及工具
</a></div> <a href="https://github.com/yinhaiying/Home" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Typescript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Home/typescript/" class="sidebar-link">目录</a></li><li><a href="/Home/typescript/ts001.html" class="sidebar-link">【001】数据类型</a></li><li><a href="/Home/typescript/ts002.html" class="sidebar-link">【002】函数</a></li><li><a href="/Home/typescript/ts003.html" class="sidebar-link">【003】接口</a></li><li><a href="/Home/typescript/ts004.html" class="sidebar-link">【004】类</a></li><li><a href="/Home/typescript/ts005.html" class="sidebar-link">【005】泛型</a></li><li><a href="/Home/typescript/ts006.html" class="sidebar-link">【006】枚举</a></li><li><a href="/Home/typescript/ts007.html" class="sidebar-link">【007】类型推论</a></li><li><a href="/Home/typescript/ts008.html" class="active sidebar-link">【008】高级类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Home/typescript/ts009.html" class="sidebar-link">【009】装饰器</a></li><li><a href="/Home/typescript/ts010.html" class="sidebar-link">【010】tsconfig配置文件</a></li><li><a href="/Home/typescript/ts011.html" class="sidebar-link">【011】发布一个ts编写的npm包</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="高级类型"><a href="#高级类型" class="header-anchor">#</a> 高级类型</h3> <h4 id="交叉类型"><a href="#交叉类型" class="header-anchor">#</a> 交叉类型</h4> <p>交叉类型是将多个类型合并为一个新的类型(并集)。 这让我们可以把现有的多种类型叠加到一起成为一种类型，它包含了所需的所有类型的特性。交叉类型通过符号<code>&amp;</code>来实现，例如， <code>Person &amp; Serializable &amp; Loggable</code>包括 <code>Person</code>和<code>Serializable</code>和<code>Loggable</code>这三种类型。 就是说这个类型的对象同时拥有了这三种类型的成员。示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> mergeFunc <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token parameter">arg1<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">,</span>arg2<span class="token operator">:</span><span class="token constant">U</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 合并</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的代码中，我们合并参数<code>arg1</code>和<code>arg2</code>，那么<code>result</code>应该同时包含<code>T</code>和<code>U</code>两种类型。因此，我们如果想要返回确定的类型，我们可以使用交叉类型<code>T&amp;U</code>。如下所示：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> mergeFunc <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>arg1<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">,</span>arg2<span class="token operator">:</span><span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token parameter"><span class="token constant">U</span></span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span><span class="token punctuation">;</span>
  result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="联合类型"><a href="#联合类型" class="header-anchor">#</a> 联合类型</h4> <p>很多情况下我们希望数据类型可以是多种类型，但是又不希望通过使用<code>any</code>来丢失对类型的验证，这时候我们可以使用联合类型。联合类型通过符号<code>|</code>来实现。<code>number|string</code>表示既可以是<code>number</code>类型，又可以是<code>string</code>类型。但是联合类型不同于交叉类型，不可以既包含<code>number</code>类型的特性又包含<code>string</code>类型的特性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> func <span class="token operator">=</span> <span class="token punctuation">(</span>arg<span class="token operator">:</span>number <span class="token operator">|</span> string<span class="token punctuation">)</span><span class="token operator">:</span><span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    result <span class="token operator">=</span> arg<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    result <span class="token operator">=</span> arg<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="类型保护"><a href="#类型保护" class="header-anchor">#</a> 类型保护</h4> <p>联合类型适合于那些值可以为不同类型的情况。但当我们想确切地了解是否为某种类型时怎么办？<code>ts</code>是无法确切地区分开来联合类型数据具体类型。示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'123'</span><span class="token punctuation">,</span><span class="token number">456</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> func2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>number <span class="token operator">|</span> <span class="token parameter">string</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> nums <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>nums <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// number | string</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// error:Property 'length' does not exist on type 'number'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的代码中，我们定义了一个<code>func2</code>函数，它会返回<code>number|string</code>联合类型。但是具体是什么类型无法确定。接下来我们直接把它的某种类型来作为判断<code>result.length</code>，这样会导致报错,因为ts在编译阶段无法确切地知道<code>result</code>的具体类型，所以<code>ts</code>会同时使用<code>number</code>和<code>string</code>类型来判断，这样的话就会导致<code>number</code>类型编译时出现错误。解决方法之一：使用类型断言，确定地告诉<code>ts</code>类型。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result <span class="token keyword">as</span> number<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用类型断言，在每个使用<code>result</code>的部分，确切地指定类型可以避免报错。但是这需要在所有地方都使用类型断言。如果使用地方较多，那么会导致不得不多次使用类型断言。不得不多次使用类型断言。因此，我们希望只要检查过一次，在之后都可以直接使用就好。<code>ts</code>提供了类型保护。<br><br>
类型保护就是一些表达式，它们会在运行时检查以确保在某个作用域里的类型。 要定义一个类型保护，我们只要简单地定义一个函数，它的返回值是一个 类型谓词：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isString</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span>number <span class="token operator">|</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span>value is string<span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在这个例子里，<code>value is string</code>就是类型谓词。 类型谓词都是 <code>parameterName is Type</code>这种形式， <code>parameterName</code>必须是来自于当前函数签名里的一个参数名,<code>type</code>必须是指定的联合类型的一种。函数体返回的是一个<code>Boolean</code>值。<br>
这样的话，每当我们需要使用类型保护时，只需要在一开始调用一下这个函数。TypeScript会将变量缩减为那个具体的类型，只要这个类型与变量的原始类型是兼容的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment">// 调用一次即可。</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如上所示，我们通过对变量<code>result</code>调用一次<code>isString</code>函数，那么<code>result</code>的变量类型就会缩减为具体的一种类型，在后面所有的使用中都是这种类型。</p> <p><strong>typeof 类型保护</strong>
在上面的代码中，我们使用类型保护去判断变量是不是<code>string</code>类型，就需要去定义一个函数。如果我们还需要判断<code>number</code>类型，那么我们还得定义一个简单的类型保护。事实上，对于这种简单地只需要通过<code>typeof xx === string</code>这种判断，ts可以直接使用<code>typeof</code>来作为类型保护。示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意：<strong>typeof类型保护</strong></p> <ol><li>只有两种形式能被识别： <code>typeof v === typename</code> 和 <code>typeof v !== typename</code>，</li> <li><code>typename</code>必须是<code>number</code>，<code>string</code>,<code>boolean</code>或<code>symbol</code>。</li></ol> <p><strong>instanceof 类型保护</strong> <code>instanceof</code>操作符是用来判断是否是某个构造函数或者类创建的实例。同样<code>ts</code>提供了<code>instanceof</code>类型保护,是通过构造函数来细化类型的一种方式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Class1</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Class2</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> func2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>Class1 <span class="token operator">|</span> <span class="token parameter">Class2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> nums <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>nums <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Class1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Class2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token keyword">instanceof</span> <span class="token class-name">Class1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">// instanceof 提供类型保护。自动</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'result是class1的实例'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'result是class2的实例'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的代码中,<code>instanceof</code>提供了类型保护，自动将实例类型缩小为具体的实例类型。</p> <h4 id="类型别名"><a href="#类型别名" class="header-anchor">#</a> 类型别名</h4> <p>类型别名会给一个类型起个新名字,但是它不会新建一个类型，它只是创建了一个新名字来引用那个类型。
类型别名通过<code>type</code> 关键字来定义。示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>type str <span class="token operator">=</span> string<span class="token punctuation">;</span>
type num <span class="token operator">=</span> number<span class="token punctuation">;</span>
<span class="token keyword">const</span> func <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token operator">:</span>str<span class="token punctuation">,</span>age<span class="token operator">:</span>num<span class="token punctuation">)</span><span class="token operator">:</span>str<span class="token operator">|</span><span class="token parameter">num</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">111</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过使用type，我们可以给类型起一个名字，在使用该类型时，直接使用名字代替,类型别名的使用有点类似于接口。但是给原始类型起别名通常没什么用，尽管可以做为文档的一种形式使用。<br> <strong>泛型类型别名</strong><br>
同接口一样，类型别名可以使用泛型，我们可以添加类型参数并且在别名声明的右侧传入。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>type Name<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">}</span>

<span class="token keyword">let</span> n<span class="token operator">:</span>Name<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'hello'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="字面量类型"><a href="#字面量类型" class="header-anchor">#</a> 字面量类型</h4> <p><strong>字符串字面量类型</strong><br>
字符串字面量类型允许你指定字符串必须的固定值。也就是这种类型必须是该字符串。示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>type Name <span class="token operator">=</span> <span class="token string">&quot;hahaha&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> n1<span class="token operator">:</span>Name <span class="token operator">=</span> <span class="token string">&quot;hahaha&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 正常赋值</span>
<span class="token keyword">let</span> n2<span class="token operator">:</span>Name <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>  <span class="token comment">// error Type '&quot;hello&quot;' is not assignable to type '&quot;hahaha&quot;'.</span>
</code></pre></div><p>使用<code>type</code>指定字面量类型为<code>hahaha</code>,那么当属于这种类型时，只能为<code>hahaha</code>,不能是其他值。
在实际应用中，字符串字面量类型可以与联合类型，类型保护和类型别名很好的配合。 通过结合使用这些特性，你可以实现类似枚举类型的字符串。示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>type Direction <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;right&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> getDirection <span class="token operator">=</span> <span class="token punctuation">(</span>direction<span class="token operator">:</span>Direction<span class="token punctuation">)</span><span class="token operator">:</span><span class="token parameter">string</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>direction <span class="token operator">===</span> <span class="token string">'left'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token string">'Go to Left'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>direction <span class="token operator">===</span> <span class="token string">'right'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token string">'Go to right'</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token string">'no'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果是联合类型的字符串字面量类型，那么你只能从指定的这几个值中选取。<br> <strong>数字字面量类型</strong><br>
数字字面量类型同字符串字面量类型一致，允许你指定数字必须的固定值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>type Num <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> num1<span class="token operator">:</span>Num <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> num2<span class="token operator">:</span>Num <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span> <span class="token comment">// Type '19' is not assignable to type '18'.</span>
</code></pre></div><h4 id="枚举成员类型"><a href="#枚举成员类型" class="header-anchor">#</a> 枚举成员类型</h4> <p>当枚举的成员满足了一定条件以后，枚举成员可以作为数据类型使用。</p> <ol><li>所有的枚举成员都是未赋值的</li> <li>所有的枚举成员都是数值</li> <li>所有的枚举成员都是字符串</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">enum</span> <span class="token constant">A</span> <span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">enum</span> <span class="token constant">B</span> <span class="token punctuation">{</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>c <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">enum</span> <span class="token constant">C</span> <span class="token punctuation">{</span>d <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>e <span class="token operator">=</span> 'world<span class="token punctuation">}</span>
</code></pre></div><p>当枚举的成员，满足上面三种任一类型时，就可以作为一种类型使用，示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">enum</span> Animal <span class="token punctuation">{</span>
    Dog <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    Cat <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">AInterface</span> <span class="token punctuation">{</span>
    type1<span class="token operator">:</span>Animal<span class="token punctuation">.</span>Dog<span class="token punctuation">,</span>   <span class="token comment">// 接口属性定义成枚举成员类型</span>
    type2<span class="token operator">:</span>Animal<span class="token punctuation">.</span>Cat<span class="token punctuation">,</span>   <span class="token comment">// 接口属性定义成枚举成员类型</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> animal<span class="token operator">:</span>AInterface <span class="token operator">=</span> <span class="token punctuation">{</span>
    type1<span class="token operator">:</span>Animal<span class="token punctuation">.</span>Dog<span class="token punctuation">,</span>  <span class="token comment">// 这里可以使用Animal.Dog</span>
    type2<span class="token operator">:</span><span class="token number">2</span>            <span class="token comment">// 也可以直接使用对应的数值</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Home/typescript/ts007.html" class="prev">
        【007】类型推论
      </a></span> <span class="next"><a href="/Home/typescript/ts009.html">
        【009】装饰器
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Home/assets/js/app.4e9de29e.js" defer></script><script src="/Home/assets/js/2.852f0768.js" defer></script><script src="/Home/assets/js/63.95bb274b.js" defer></script>
  </body>
</html>
